DROP TABLE D7_ORDER;
﻿DROP TABLE D7_PRODUCT;

CREATE TABLE D7_PRODUCT(
	PID VARCHAR(20) PRIMARY KEY,
	PNAME VARCHAR(50) NOT NULL,
	PRICE NUMBER NOT NULL
);

CREATE TABLE D7_ORDER(
	OID VARCHAR(10) PRIMARY KEY,
	PID VARCHAR(20) NOT NULL,
	QUANTITY NUMBER NOT NULL,
	ODATE DATE NOT NULL,
	CONSTRAINT FK_ORDER_PRODUCT FOREIGN KEY (PID) REFERENCES D7_PRODUCT (PID)
);

INSERT INTO D7_PRODUCT VALUES('P001', '이자녹스', 23000);
INSERT INTO D7_PRODUCT VALUES('P002', '리엔', 8800);
INSERT INTO D7_PRODUCT VALUES('P003', '죽염치약', 5500);
INSERT INTO D7_PRODUCT VALUES('P004', '페리오', 3400);
INSERT INTO D7_PRODUCT VALUES('P005', '온더바디', 9900);
INSERT INTO D7_PRODUCT VALUES('P006', '샤프란', 11500);
INSERT INTO D7_PRODUCT VALUES('P007', '테크', 9500);
INSERT INTO D7_PRODUCT VALUES('P008', '드봉', 2000);
INSERT INTO D7_PRODUCT VALUES('P009', '엘라스틴', 15000);
INSERT INTO D7_PRODUCT VALUES('P010', '조지아', 1000);
INSERT INTO D7_PRODUCT VALUES('P011', '조지아-블루', 1500);
INSERT INTO D7_PRODUCT VALUES('P012', '킨사이다', 1000);
INSERT INTO D7_PRODUCT VALUES('P013', '코카콜라', 1500);
INSERT INTO D7_PRODUCT VALUES('P014', '스프라이트', 2000);
INSERT INTO D7_PRODUCT VALUES('P015', '환타', 1000);
INSERT INTO D7_PRODUCT VALUES('P016', '숨', 25000);
INSERT INTO D7_PRODUCT VALUES('P017', '수려한', 55000);

INSERT INTO D7_ORDER VALUES('O-001', 'P001', 3, '2014/01/04');
INSERT INTO D7_ORDER VALUES('O-002', 'P004', 1, '2014/01/04');
INSERT INTO D7_ORDER VALUES('O-003', 'P001', 10, '2014/01/04');
INSERT INTO D7_ORDER VALUES('O-004', 'P001', 30, '2014/01/05');
INSERT INTO D7_ORDER VALUES('O-005', 'P011', 2, '2014/01/05');
INSERT INTO D7_ORDER VALUES('O-006', 'P012', 1, '2014/01/05');
INSERT INTO D7_ORDER VALUES('O-007', 'P011', 3, '2014/01/06');
INSERT INTO D7_ORDER VALUES('O-008', 'P012', 13, '2014/01/07');
INSERT INTO D7_ORDER VALUES('O-009', 'P013', 3, '2014/01/07');
INSERT INTO D7_ORDER VALUES('O-010', 'P014', 2, '2014/01/07');
INSERT INTO D7_ORDER VALUES('O-011', 'P014', 2, '2014/01/08');
INSERT INTO D7_ORDER VALUES('O-012', 'P001', 1, '2014/01/08');
INSERT INTO D7_ORDER VALUES('O-013', 'P007', 4, '2014/01/08');
INSERT INTO D7_ORDER VALUES('O-014', 'P008', 5, '2014/01/08');
INSERT INTO D7_ORDER VALUES('O-015', 'P001', 10, '2014/01/20');
INSERT INTO D7_ORDER VALUES('O-016', 'P007', 20, '2014/01/20');
INSERT INTO D7_ORDER VALUES('O-017', 'P014', 5, '2014/01/20');
INSERT INTO D7_ORDER VALUES('O-018', 'P013', 3, '2014/01/21');
INSERT INTO D7_ORDER VALUES('O-019', 'P007', 2, '2014/02/02');
INSERT INTO D7_ORDER VALUES('O-020', 'P008', 1, '2014/02/02');
INSERT INTO D7_ORDER VALUES('O-021', 'P008', 1, '2014/02/04');
INSERT INTO D7_ORDER VALUES('O-022', 'P009', 1, '2014/02/04');
INSERT INTO D7_ORDER VALUES('O-023', 'P001', 5, '2014/02/04');
INSERT INTO D7_ORDER VALUES('O-024', 'P012', 5, '2014/03/04');
INSERT INTO D7_ORDER VALUES('O-025', 'P001', 2, '2014/03/04');

COMMIT;

SELECT TO_CHAR(ODATE, 'YYYY-MM-DD') 영업일, SUM(O.QUANTITY*P.PRICE) 매출 FROM D7_ORDER O, D7_PRODUCT P
GROUP BY ODATE
ORDER BY 1
;

SELECT PNAME 상품명, SUM(O.QUANTITY*P.PRICE) 매출 FROM D7_ORDER O, D7_PRODUCT P
GROUP BY PNAME
ORDER BY 2 DESC
;